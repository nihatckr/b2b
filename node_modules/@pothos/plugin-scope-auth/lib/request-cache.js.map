{"version":3,"sources":["../src/request-cache.ts"],"names":["RequestCache","contextCache","createContextCache","ctx","builder","fromContext","context","clearForContext","delete","getScopes","scopes","options","scopeAuth","authScopes","isThenable","then","resolved","withScopes","cb","resolvedScopes","saveGrantedScopes","path","key","cacheKey","grantCache","has","set","get","scope","add","Set","testGrantedScopes","prev","grantTypeScopes","type","parent","typeGrants","Map","cache","result","evaluateScopeLoader","name","arg","scopeCache","loader","PothosValidationError","String","bind","treatErrorsAsUnauthorized","error","kind","AuthScopeFailureType","AuthScope","parameter","promise","r","catch","evaluateScopeMapWithScopes","$all","$any","$granted","map","info","forAll","scopeNames","Object","keys","problems","failure","AllAuthScopes","AnyAuthScopes","failures","loaderList","scopeName","push","promises","GrantedScope","anyResult","evaluateScopeMap","allResult","resolveAndReturn","loaderName","length","Promise","all","results","hasSuccess","val","defaultStrategy","AuthScopeFunction","mapCache","canCache","evaluateTypeScopeFunction","typeCache"],"mappings":"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"}